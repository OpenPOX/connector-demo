package confluence

import (
	"testing"

	"connector-demo/auth"
	"connector-demo/utils"
)

func TestConfluenceConnector_GetPages(t *testing.T) {
	tm := utils.NewTokenManager()
	tm.SaveToken("a2386640-5a27-4db2-baf2-81a039fe9708", auth.ProviderConfluence, &utils.TokenInfo{
		AccessToken: "eyJraWQiOiJhdXRoLmF0bGFzc2lhbi5jb20tQUNDRVNTLTk0ZTczYTkwLTUxYWQtNGFjMS1hOWFjLWU4NGUwNDVjNDU3ZCIsImFsZyI6IlJTMjU2In0.eyJqdGkiOiIwMDNjYTI3Ny05NjExLTQzMDgtOWNlYy1kYzYwNDJjMjQwZDciLCJzdWIiOiI3MTIwMjA6YWJhN2EwZjgtNDZkOC00YWFkLTgxMDUtNjVhNDk5ZDI1M2JlIiwibmJmIjoxNzU3NTg2MzU2LCJpc3MiOiJodHRwczovL2F1dGguYXRsYXNzaWFuLmNvbSIsImlhdCI6MTc1NzU4NjM1NiwiZXhwIjoxNzU3NTg5OTU2LCJhdWQiOiJJaVZCdllHTE1BbXJSUkJFTU5LcXdHb2tTaDVkbEVROSIsImh0dHBzOi8vYXRsYXNzaWFuLmNvbS9zeXN0ZW1BY2NvdW50SWQiOiI3MTIwMjA6YjAzODZjNWEtYjQ2OS00ZjM0LThlOWEtYTAxOTcwOGMwMzY3IiwiaHR0cHM6Ly9hdGxhc3NpYW4uY29tL29hdXRoQ2xpZW50SWQiOiJJaVZCdllHTE1BbXJSUkJFTU5LcXdHb2tTaDVkbEVROSIsImh0dHBzOi8vYXRsYXNzaWFuLmNvbS9hdXRoUHJvZmlsZSI6Im9hdXRoLmVjb3N5c3RlbS5vYXV0aEludGVncmF0aW9uIiwiaHR0cHM6Ly9pZC5hdGxhc3NpYW4uY29tL2F0bF90b2tlbl90eXBlIjoiQUNDRVNTIiwiaHR0cHM6Ly9pZC5hdGxhc3NpYW4uY29tL3JlZnJlc2hfY2hhaW5faWQiOiJJaVZCdllHTE1BbXJSUkJFTU5LcXdHb2tTaDVkbEVROS03MTIwMjA6YWJhN2EwZjgtNDZkOC00YWFkLTgxMDUtNjVhNDk5ZDI1M2JlLTY2NDg3ZDVlLWJiNTMtNDZhNC05M2Y0LWIxMTNkYWIxYzBkYSIsInNjb3BlIjoib2ZmbGluZV9hY2Nlc3MgcmVhZDphdHRhY2htZW50OmNvbmZsdWVuY2UgcmVhZDpjb250ZW50LWRldGFpbHM6Y29uZmx1ZW5jZSByZWFkOmNvbnRlbnQubWV0YWRhdGE6Y29uZmx1ZW5jZSByZWFkOmNvbnRlbnQ6Y29uZmx1ZW5jZSByZWFkOnBhZ2U6Y29uZmx1ZW5jZSByZWFkOnNwYWNlLWRldGFpbHM6Y29uZmx1ZW5jZSByZWFkOnNwYWNlLnBlcm1pc3Npb246Y29uZmx1ZW5jZSByZWFkOnNwYWNlOmNvbmZsdWVuY2UiLCJodHRwczovL2F0bGFzc2lhbi5jb20vZmlyc3RQYXJ0eSI6ZmFsc2UsImh0dHBzOi8vYXRsYXNzaWFuLmNvbS92ZXJpZmllZCI6dHJ1ZSwidmVyaWZpZWQiOiJ0cnVlIiwiaHR0cHM6Ly9pZC5hdGxhc3NpYW4uY29tL3VqdCI6ImJmMzA1ODA3LTQwNmEtNGE3My04NGMxLTZjMWEzODQxMDYwYyIsImh0dHBzOi8vaWQuYXRsYXNzaWFuLmNvbS9wcm9jZXNzUmVnaW9uIjoidXMtd2VzdC0yIiwiY2xpZW50X2lkIjoiSWlWQnZZR0xNQW1yUlJCRU1OS3F3R29rU2g1ZGxFUTkiLCJodHRwczovL2lkLmF0bGFzc2lhbi5jb20vcnRpIjoiM2NkNzkwNTgtYTg3ZS00YmI5LWI0ZDYtN2ZkZDNjYjZkN2Y4IiwiaHR0cHM6Ly9hdGxhc3NpYW4uY29tL2VtYWlsRG9tYWluIjoiZ21haWwuY29tIiwiaHR0cHM6Ly9hdGxhc3NpYW4uY29tL3N5c3RlbUFjY291bnRFbWFpbCI6ImM5ZGE2Y2RkLTc4ZDYtNGE1Ny04OGQ2LWY5YjBjOWUwZWQyNUBjb25uZWN0LmF0bGFzc2lhbi5jb20iLCJodHRwczovL2F0bGFzc2lhbi5jb20vM2xvIjp0cnVlLCJodHRwczovL2lkLmF0bGFzc2lhbi5jb20vdmVyaWZpZWQiOnRydWUsImh0dHBzOi8vaWQuYXRsYXNzaWFuLmNvbS9zZXNzaW9uX2lkIjoiMjNhYjU2ZmItNDU5OC00ZWNjLWEwOGEtNDc2NTY3MDM4MGQxIiwiaHR0cHM6Ly9hdGxhc3NpYW4uY29tL3N5c3RlbUFjY291bnRFbWFpbERvbWFpbiI6ImNvbm5lY3QuYXRsYXNzaWFuLmNvbSJ9.nv3REjs_k7ZJXE0r2g1XYsByU069GPW0eCRzE1CgVtnZ0IYZH97u3SfRPdgAGuC07KMtjUhZr_uxupHcGKKOaFGAMeUeT2CouucmLYqYvMyPngZrNIARgTIBKXEudHt3CEee-fLIURshZRp6tAT8MOp-5yEhprJtCVGsD0M_ofDhAJvLydiceHX_6l6ifBXcHr8OoFGbRKhEDzykrB9J2KSQ8J-VrLk-b-kDvHeHGuleFvxr2OE3CVRZBTE3JZJ7TnuFVK2Mlt6gzhunIoRF4y-qJfbFgnIKmr7qfAqSsHs2HiBU7zkqCgvCOi0oCZYqg8vFvbmQN0-axuB6vDdRxg",
		Provider:    auth.ProviderConfluence,
		TokenType:   "Bearer",
	})
	conn := NewConfluenceConnector(tm)
	ret1, ret2, err := conn.GetPages("a2386640-5a27-4db2-baf2-81a039fe9708")
	t.Logf("ret1=%+v, ret2=%+v, err=%v", ret1, ret2, err)
	for _, i := range ret1.Results {
		t.Logf("page: %+v", i)
	}
}
